databaseChangeLog:
    - changeSet:
        id: 1.0-1
        author: howed
        comment: Create street_posting_box table
        changes:
        - createTable:
            tableName: street_posting_box
            columns:
            - column:
                name: id
                type: int
                autoIncrement: true
                constraints:
                    primaryKey: true
                    nullable: false
            - column:
                name: imei
                type: varchar(15)
                constraints:
                    nullable: false
            - column:
                name: timezone
                type: varchar(30)
                constraints:
                    nullable: false
            - column:
                name: api_key
                type: varchar(36)
                constraints:
                    nullable: true
            - column:
                name: prev_api_key
                type: varchar(36)
                constraints:
                    nullable: true
            - column:
                name: version
                type: int
                constraints:
                    nullable: false
        - createIndex:
              columns:
              - column:
                  name: imei
              indexName: idx_spb_01
              tableName: street_posting_box
              unique: true

    - changeSet:
        id: 1.0-1-dev
        author: howed
        comment: Insert SPB data for local development
        context: dev
        changes:
            - insert:
                tableName: street_posting_box
                columns:
                - column:
                    name: imei
                    value: IMEI12345678902
                - column:
                    name: timezone
                    value: Australia/Perth
                - column:
                    name: api_key
                    value: 16fa2ee7-6614-4f62-bc16-a3c6fa189675
                - column:
                    name: prev_api_key
                    value: a73c5740-1cde-40a9-bde7-1d5e44761f77
                - column:
                    name: version
                    value: 1
    - changeSet:
        id: 1.0-2
        author: howed
        comment: Create reading table
        changes:
        - createTable:
            tableName: reading
            columns:
            - column:
                name: id
                type: int
                autoIncrement: true
                constraints:
                    primaryKey: true
                    nullable: false
            - column:
                name: street_posting_box_id
                type: int
                constraints:
                    nullable: false
                    foreignKeyName: fk_reading_spb
                    references: street_posting_box(id)
            - column:
                name: date_time
                type: datetime
                constraints:
                    nullable: false
            - column:
                name: grams
                type: int
                constraints:
                    nullable: false
            - column:
                name: degreesC
                type: number(4, 1)
        - createIndex:
              columns:
              - column:
                  name: street_posting_box_id
              indexName: idx_reading_01
              tableName: reading

        - insert:
            tableName: reading
            columns:
            - column:
                name: street_posting_box_id
                value: 1
            - column:
                name: date_time
                valueDate: "2016-11-01T07:00:00"
            - column:
                name: grams
                value: 150
            - column:
                name: degreesc
                value: 21.3
        - insert:
            tableName: reading
            columns:
            - column:
                name: street_posting_box_id
                value: 1
            - column:
                name: date_time
                valueDate: "2016-11-01T07:01:00"
            - column:
                name: grams
                value: 161
            - column:
                name: degreesc
                value: 21.4

    - changeSet:
        id: 1.0-3
        author: howed
        comment: Create remote_config table
        changes:
        - createTable:
            tableName: remote_config
            columns:
            - column:
                name: id
                type: int
                constraints:
                    primaryKey: true
                    nullable: false
            - column:
                name: version
                type: int
                constraints:
                    nullable: false

        - createTable:
            tableName: remote_config_prop
            columns:
            - column:
                name: remote_config_id
                type: int
                constraints:
                    primaryKey: true
                    nullable: false
            - column:
                name: name
                type: varchar(32)
                constraints:
                    primaryKey: true
                    nullable: false
            - column:
                name: value
                type: varchar(256)
                constraints:
                    nullable: true
            - column:
                name: description
                type: varchar(256)
                constraints:
                    nullable: true

        - insert:
            tableName: remote_config
            columns:
            - column:
                name: id
                value: 1
            - column:
                name: version
                value: 1
        - insert:
            tableName: remote_config_prop
            columns:
            - column:
                name: remote_config_id
                value: 1
            - column:
                name: name
                value: url
            - column:
                name: description
                value: The base URL for the remote REST web services.
        - insert:
            tableName: remote_config_prop
            columns:
            - column:
                name: remote_config_id
                value: 1
            - column:
                name: name
                value: readingSeconds
            - column:
                name: description
                value: The number of seconds between readings of the SPB weight.
        - insert:
            tableName: remote_config_prop
            columns:
            - column:
                name: remote_config_id
                value: 1
            - column:
                name: name
                value: sleepSeconds
            - column:
                name: description
                value: The number of seconds the microcontroller should sleep for.

    - changeSet:
        id: 1.0-3-dev
        author: howed
        comment: Insert remote_config data for local development
        context: dev
        changes:
        - update:
            tableName: remote_config_prop
            columns:
            - column:
                name: value
                value: http://localhost:8080/rest/remote
            where: remote_config_id = 1 AND name='url'
        - update:
            tableName: remote_config_prop
            columns:
            - column:
                name: value
                value: 8
            where: remote_config_id = 1 AND name='readingSeconds'
        - update:
            tableName: remote_config_prop
            columns:
            - column:
                name: value
                value: 8
            where: remote_config_id = 1 AND name='sleepSeconds'
